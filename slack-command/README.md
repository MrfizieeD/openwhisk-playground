OpenWhisk minimal Slack command example
===

This is a minimal example of a Slack command running on OpenWhisk - it evaluates
simple expressions using https://www.npmjs.com/package/jexl

Deploying and testing with curl
---

In their simplest form, that we are using here, Slack commands call a specified URL and 
display the plain text response in the Slack client.

So we first need to activate our OpenWhisk Web action so that it can be called with
an HTTP request.

Here's how to do that, assuming you have the `wsk` command correctly setup:

    # Verify that wsk works
    wsk list
    
    # Install libs
    npm install

    # Test from the command line
    $ node slack-eval.js 2+3
    
        request params: {
          "text": "2+3"
        }
        2+3 = *5*
    
    # Install our HTTP command handler
    zip -r action.zip package.json *.js node_modules && wsk action update eval action.zip --web true --kind nodejs:10
    
    ...ok: updated action eval...
    
    # Get its URL and test with curl
    export URL=$(wsk -i action get eval --url | grep http)
    curl -L -k "$URL?text=2*3"
    
    ...outputs 6...
    
Slack setup
---

To setup our OpenWhisk Action as a Slack slash command, you need admin access to a Slack workspace.

If needed, you can create such a workspace for free at https://slack.com/

Once you have a workspace with admin rights:

 * Create a Slack app from https://api.slack.com/apps?new_app=1
 * View your Slack apps at https://api.slack.com/apps
 * Create a command via `https://api.slack.com/apps/<APP-ID>/slash-commands?`, replacing `<APP-ID>` with
   the ID that was generated by your app.
 
 When you create the Slack command, you'll need to supply (in the Slack "Request URL" field) the URL 
 that's output by the following OpenWhisk command, that we already used above:
 
    wsk -i action get eval --url     
    
You'll need to give a name to your command (in the Slack "Command" field), for our tests we use `/eval`    
    
Usage in Slack
---

Once the commmand is installed, you can execute it from Slack by typing simple expressions like

    /eval 2+3
    /eval now
  
